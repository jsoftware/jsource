prolog './gsp521.ijs'
NB. {. -------------------------------------------------------------------

x=: 0 00
y=: 12 24 3$9 2 _3 10 _1 10 0 _9 1 7 3 _9 _2 _8 _1 3 0 _6 2 _7 _10 2 10 4 _2 _5 6 _4 _7 _2 9 10 _9 _9 7 9 _5 _7 6 1 _5 9 6 2 5 _5 _4 _10 1 _9 _5 _10 _6 _2 0 _1 9 3 7 7 2 1 _7 4 6 _1 _10 _10 _2 7 _1 _5 _10 _5 _5 0 3 _5 _10 1 _4 _10 3 _1 _3 _8 _3 6 6 0 _7 _4 _5 _5 9 _2 3 _2 _8 _9 1 _9 0 _9 _7 _6 _6 0 1 _2 _8 10 5 _3 4 1 0 _6 7 10 8 _10 1 _3 2 _1 _2 _2 _4 2 _4 8 _4 _6 7 _5 _9 _3 3 5 _3 6 _6 _8 _4 _10 4 7 _8 _6 _4 6 _10 _8 5 _6 7 _3 7 _2 7 _8 4 2 5 2 _7 9 _9 6 _5 10 7 2 0 1 9 7 _4 4 _10 _4 _7 _7 8 _6 2 4 _1 _3 _6 9 _7 _9 0 _10 10 2 4 5 3 4 8 7 _7 _8 3 _1 _9 10 4 8 _5 5 _1 _4 _3 _3 5 10 7 2 _10 _5 _6 8 0 _8 _4 _6 0 5 _3 _2 6 _7 8 _2 0 1 9 5 0 4 9 _3 0 _6 7 _7 _8 9 _2 1 7 1 0 9 _2 _7 _2 _5 4 _4 2 6 _9 _1 _1 _3 _4 _10 _4 _6 _8 _7 2 _2 5 _4 _5 _10 _8 4 4 7 _9 _7 _5 _4 _10 8 0 3 6 _4 _4 1 9 _7 10 1 _2 _6 2 5 _5 7 1 8 5 _3 4 2 _9 1 2 _8 _7 _3 7 1 3 4 _7 _2 _5 _10 5 _6 8 _6 _1 _2 8 _3 _4 _1 3 _2 7 3 _6 _3 9 _3 7 7 5 9 4 9 4 5 _4 _7 5 10 _1 7 7 0 _9 0 9 _3 _9 _6 _7 _2 7 _10 _6 0 _8 9 _8 _4 _10 _2 _6 8 _9 3 6 5 5 10 _1 _3 _3 _6 5 _1 0 1 6 6 _5 _9 _8 0 _9 6 3 3 8 _4 _10 _1 _6 _4 6 _7 _9 _10 _6 _5 _8 _5 _3 10 8 _9 _4 10 9 5 9 1 _7 _1 _8 _7 1 _3 6 4 _10 _7 _3 3 9 0 _7 _10 6 9 0 10 _1 3 9 1 6 8 0 _9 4 2 _9 2 5 _6 3 _3 _5 _7 _5 8 _8 10 3 8 _5 6 _1 1 _1 5 _4 3 10 _1 _7 _5 5 _6 _4 2 6 _9 _10 6 6 5 _2 5 _8 5 _3 2 5 _4 10 _3 _1 5 3 4 _6 0 10 _9 _10 3 _4 7 9 _6 _2 9 _2 5 _7 4 _1 _8 _9 4 _6 _6 9 5 7 _5 _9 _9 _9 1 _7 _7 0 _4 _4 6 1 _8 _9 _8 _1 2 10 9 _1 2 0 0 _2 _5 5 6 10 5 1 2 _3 7 10 _1 8 4 _8 _9 2 _5 _7 10 4 2 _1 4 _8 5 _8 _5 1 7 _1 _10 1 _2 _5 0 9 5 _3 6 4 2 8 10 7 _1 _1 _6 _4 5 _2 5 _6 6 _10 4 5 1 _8 5 2 _5 _3 9 _2 _10 _9 9 10 1 4 _9 5 3 _8 _1 3 _10 8 1 5 _4 7 3 6 6 10 _6 5 _8 _7 4 0 _9 _6 _8 5 9 5 _8 _4 _7 _8 4 4 _2 8 _4 5 4 _4 4 _7 9 2 5 7 _10 6 6 _2 4 3 _3 _8 _5 7 8 _1 _10 5 7 _10 _6 3 _5 3 _6 6 _9 10 7 _3 _6 _4 2 _4 7 _2 _5 1 _5 _4 0 6 10 _6 3 0 _3 _2 _4 8 _5 2 _6 7 3 2 _10 _8 8 _2 4 _10 5 _6 9 _4 _7 _9 _3 _9 3 6 _5 _3 _5 _5 _2 5 _10 0 3 2 7 3 _6 _4 8 6 _2 _6 _4 _3 2 _9 8 7 7 _3 3 _8 1 7 _6 _5 _9 3 _3 1 8 _5 _6 _6 8 _8 _5 _5 9 7 3 _6 0 10 4 5 4 _9 _5 4 _6 3 6 _5 _6 0 3 _8 7 7 _2 3 _1 _8 _6 _1 7 _7 _3 6 _1 _5 _4 10 _1 2 _9 _5 _7 _3 4 4 _8 2 3 3 _3 _1 _2 _1 _2 5 _10 5 _2 _5 3 _8 _5 8 6 0 _8 0 _3 6 1 0 _5 _8 7 _7 8 0 9
(scheck x{."2$.y), (x) ({."2 -: {."2&.$.) y  NB. sparse x with no nonsparse elements failed (by losing the rank)

(scheck x{.$.y), (x=:_5 _10+?12 24) ({. -: {.&.$.) y=:          ?  12 24 3$2
(scheck x{.$.y), (x=:_5 _10+?12 24) ({. -: {.&.$.) y=:      _10+?  12 24 3$21
(scheck x{.$.y), (x=:_5 _10+?12 24) ({. -: {.&.$.) y=:    o._10+?  12 24 3$21
(scheck x{.$.y), (x=:_5 _10+?12 24) ({. -: {.&.$.) y=: j./o._10+?2 12 24 3$21

(scheck x{.$.y), (x=:0     ) ({. -: {.&.$.) y=:          ?  12 24 3$2
(scheck x{.$.y), (x=:3 2 0 ) ({. -: {.&.$.) y=:      _10+?  12 24 3$21
(scheck x{.$.y), (x=:2 0 3 ) ({. -: {.&.$.) y=:    o._10+?  12 24 3$21
(scheck x{.$.y), (x=:2 0   ) ({. -: {.&.$.) y=: j./o._10+?2 12 24 3$21

(scheck x{.$.y), (x=:_     ) ({. -: {.&.$.) y=:          ?  12 24 3$2
(scheck x{.$.y), (x=:3 2 _ ) ({. -: {.&.$.) y=:      _10+?  12 24 3$21
(scheck x{.$.y), (x=:2 _ 3 ) ({. -: {.&.$.) y=:    o._10+?  12 24 3$21
(scheck x{.$.y), (x=:2 _   ) ({. -: {.&.$.) y=: j./o._10+?2 12 24 3$21

(scheck x{.$.y), (x=:__    ) ({. -: {.&.$.) y=:          ?  12 24 3$2
(scheck x{.$.y), (x=:3 2 __) ({. -: {.&.$.) y=:      _10+?  12 24 3$21
(scheck x{.$.y), (x=:2 __ 3) ({. -: {.&.$.) y=:    o._10+?  12 24 3$21
(scheck x{.$.y), (x=:2 __  ) ({. -: {.&.$.) y=: j./o._10+?2 12 24 3$21

(x {.!.e y) -: $.^:_1 (x=: 10 20){. (3;e=:?100)$.$.y=:       2 3 5$1 
(x {.!.e y) -: $.^:_1 (x=: 10 20){. (3;e=:?100)$.$.y=:    1+?2 3 5$21
(x {.!.e y) -: $.^:_1 (x=: 10 20){. (3;e=:?100)$.$.y=: o. 1+?2 3 5$21
(x {.!.e y) -: $.^:_1 (x=: 10 20){. (3;e=:?100)$.$.y=: j./1+?2 3 5$21

(scheck x{."1$.y), (x=:12     -~?25     ) ({."1 -: {."1&.$.) y=:_10+?12 24 3$21
(scheck x{."2$.y), (x=:12 24  -~?25 49  ) ({."2 -: {."2&.$.) y=:_10+?12 24 3$21
(scheck x{."3$.y), (x=:12 24 3-~?25 49 7) ({."3 -: {."3&.$.) y=:_10+?12 24 3$21

x=: _1 2
y=: 10*i.2 3 4
(scheck x{.t), (x{.y) -: $.^:_1 x{.t=: (2;0    )$.$.y
(scheck x{.t), (x{.y) -: $.^:_1 x{.t=: (2;1    )$.$.y
(scheck x{.t), (x{.y) -: $.^:_1 x{.t=: (2;2    )$.$.y
(scheck x{.t), (x{.y) -: $.^:_1 x{.t=: (2;0 1  )$.$.y
(scheck x{.t), (x{.y) -: $.^:_1 x{.t=: (2;0 2  )$.$.y
(scheck x{.t), (x{.y) -: $.^:_1 x{.t=: (2;1 0  )$.$.y
(scheck x{.t), (x{.y) -: $.^:_1 x{.t=: (2;1 2  )$.$.y
(scheck x{.t), (x{.y) -: $.^:_1 x{.t=: (2;2 0  )$.$.y
(scheck x{.t), (x{.y) -: $.^:_1 x{.t=: (2;2 1  )$.$.y
(scheck x{.t), (x{.y) -: $.^:_1 x{.t=: (2;0 1 2)$.$.y
(scheck x{.t), (x{.y) -: $.^:_1 x{.t=: (2;0 2 1)$.$.y
(scheck x{.t), (x{.y) -: $.^:_1 x{.t=: (2;1 0 2)$.$.y
(scheck x{.t), (x{.y) -: $.^:_1 x{.t=: (2;1 2 0)$.$.y
(scheck x{.t), (x{.y) -: $.^:_1 x{.t=: (2;2 0 1)$.$.y
(scheck x{.t), (x{.y) -: $.^:_1 x{.t=: (2;2 1 0)$.$.y


4!:55 ;:'e t x y'



epilog''

